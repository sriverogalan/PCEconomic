<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
    <head th:replace="layout/layout.html :: head"></head>
    <body class="bgbd">
        <header th:replace="layout/layout.html :: header"></header>
        <main class="container-lg bg-cont mt-md-5 mt-1">
            <section class="col-12 mt-5">
                <img th:src="@{/img/static/slider.webp}" class="img-fluid col-12 h-50 slider-principal"
                     alt="slider-principal">
            </section>
            <section id="productes" class="row mt-5 justify-content-center">
                <div id="articles" class="row  mt-2 mb-2"></div>


                <!--
                <a th:each="prop : ${propietats}"
                   th:href="@{/article/{id}/{idPropietat}(id=${prop.article.id},idPropietat=${prop.id})}"
                   class="col-xs-12 col-sm-6 col-lg-4 text-center text-decoration-none card d-flex align-items-center">
                    <div th:each="img : ${imatges}">
                        <img th:if="${img.propietats.id == prop.id && img.principal == true}"
                             th:src="@{/img/productes/{idArticle}/{idPropietat}/{idPath} (idArticle=${prop.article.id}, idPropietat=${img.propietats.id}, idPath=${img.path})} "
                             class="card-img-top col-12 imgSize" alt="img" >
                        <div th:if="${img.propietats.id != prop.id}" th:remove="tag"></div>
                    </div>
                    <div class="card-body align-items-center">
                        <p th:text="${prop.article.nom}"></p>
                        <p th:each="valor : ${prop.valor}" th:text="${valor.propietat.nom} +':' + ${valor.valor}">
                        </p>
                    </div>
                </a>-->
            </section>
        </main>
        <footer th:replace="layout/layout.html :: footer"></footer>
    </body>
    <div th:replace="layout/layout.html :: jquery"></div>
    <script>
        $.ajax({
            url: "/api/articles",
            type: "GET",
            dataType: "json",
            success: function (resp) {
                console.log(resp);
                var articles = resp;
                for (var img of resp) {
                    if (img.principal === true && img.propietats.esPrincipal === true) {
                        $('#articles').append(
                            '<a href="http://localhost:8080/article/' + img.propietats.article.id + '/' + img.propietats.id + '" class="col-xs-12 col-sm-6 col-lg-4 text-end text-decoration-none card d-flex align-items-center">' +
                            '<span class="text-end h2 text-pc-economic-default bold col-12">' + img.propietats.preu + ' € </span>' +
                            '<img src="/img/productes/' + img.propietats.article.id + '/' + img.propietats.id + '/' + img.path + '" class="card-img-top col-12 object-fit-cover" alt="img">' +
                            '<div class="col-12 justify-content-center row">' +
                            '<div id="' + img.propietats.id + '" class="row justify-content-around col-12"></div>' +
                            '<div class="text-start h3 col-12"> <p>' + img.propietats.article.nom + '</p></div>' +
                            '<span class="text-success col-12 text-start mb-2"> Recíbelo mañana </span>' +
                            '</div>' +
                            '</div>' +
                            '</a>'
                        );
                        for (var i of articles) {
                            if (i.principal === true && i.propietats.esPrincipal === false && i.propietats.article.id === img.propietats.article.id) {
                                $('#' + img.propietats.id).append(
                                    '<img src="/img/productes/' + i.propietats.article.id + '/' + i.propietats.id + '/' + i.path + '" class="col-2 mt-2 mb-2" alt="img">'
                                );
                            }
                        }
                    }
                }
            },
        });
    </script>
</html>
